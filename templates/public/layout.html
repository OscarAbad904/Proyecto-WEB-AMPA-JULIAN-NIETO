<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}AMPA Julián Nieto Tapia{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/AMPA.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
    <script src="{{ url_for('static', filename='js/AMPA.js') }}" defer></script>
    {% block head %}{% endblock %}
</head>
<body>
<!-- Header -->
    <header class="header-fixed">
        <nav class="container-nav">
            <div class="header-flex">
                <div class="header-top">
                    <div class="header-logo-group">
                        <div class="logo-bg">
                            <img src="{{ url_for('static', filename='images/Logo_AMPA.png') }}" alt="Logo AMPA Julián Nieto Tapia" class="logo-img" />
                        </div>
                        <span class="header-title-group">
                            <span class="header-title-ampa">AMPA</span>
                            <span class="header-title-colegio">Julián Nieto Tapia</span>
                        </span>
                    </div>
                    <div class="header-utilities">
                        <div class="buscador-desktop">
                            <input type="text" placeholder="Buscar..." class="buscador-input" id="buscadorAMPA" oninput="buscarEnPagina()" />
                        </div>
                        <div class="nav-auth">
                            {% if current_user.is_authenticated %}
                                {% if can_manage_members and request.endpoint in ['public.noticias', 'public.eventos', 'public.documentos'] %}
                                    <a href="{{ url_for('admin.posts') }}" class="nav-auth-btn nav-auth-btn--edit">Edición</a>
                                {% endif %}
                                <span class="nav-user-name">Bienvenido, {{ current_user.username }}</span>
                                <a href="{{ url_for('members.logout') }}" class="nav-auth-btn nav-auth-btn--logout">Cerrar sesión</a>
                            {% else %}
                                <button type="button" class="nav-auth-btn" onclick="toggleLoginModal(true)">Login</button>
                            {% endif %}
                        </div>
                    </div>
                    <div class="nav-desktop">
                        <a href="{{ url_for('public.home') }}" class="nav-link">Inicio</a>
                        <a href="{{ url_for('public.quienes_somos') }}" class="nav-link">Quiénes Somos</a>
                        <a href="{{ url_for('public.noticias') }}" class="nav-link">Noticias</a>
                        <a href="{{ url_for('public.eventos') }}" class="nav-link">Eventos</a>
                        <a href="{{ url_for('public.documentos') }}" class="nav-link">Documentos</a>
                        <a href="{{ url_for('public.contacto') }}" class="nav-link">Contacto</a>
                        <a href="{{ url_for('public.faq') }}" class="nav-link">FAQ</a>
                        {% if current_user.is_authenticated %}
                            <a href="{{ url_for('members.dashboard') }}" class="nav-link">Área privada</a>
                            {% if can_manage_members %}
                                <a href="{{ url_for('members.register') }}" class="nav-link">Crear cuenta</a>
                            {% endif %}
                        {% endif %}
                    </div>
                    <button class="menu-mobile-btn" onclick="toggleMobileMenu()">
                        <svg class="menu-mobile-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>

            </div>
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="mobile-menu">
                <div class="mobile-menu-links">
                    <a href="{{ url_for('public.home') }}" class="nav-link" onclick="toggleMobileMenu()">Inicio</a>
                    <a href="{{ url_for('public.quienes_somos') }}" class="nav-link" onclick="toggleMobileMenu()">Quiénes Somos</a>
                    <a href="{{ url_for('public.noticias') }}" class="nav-link" onclick="toggleMobileMenu()">Noticias</a>
                    <a href="{{ url_for('public.eventos') }}" class="nav-link" onclick="toggleMobileMenu()">Eventos</a>
                    <a href="{{ url_for('public.documentos') }}" class="nav-link" onclick="toggleMobileMenu()">Documentos</a>
                    <a href="{{ url_for('public.contacto') }}" class="nav-link" onclick="toggleMobileMenu()">Contacto</a>
                    <a href="{{ url_for('public.faq') }}" class="nav-link" onclick="toggleMobileMenu()">FAQ</a>
                    {% if current_user.is_authenticated %}
                        <a href="{{ url_for('members.dashboard') }}" class="nav-link" onclick="toggleMobileMenu()">Área privada</a>
                        {% if can_manage_members %}
                            <a href="{{ url_for('members.register') }}" class="nav-link" onclick="toggleMobileMenu()">Crear cuenta</a>
                        {% endif %}
                    {% endif %}
                    <div class="mobile-auth">
                        {% if current_user.is_authenticated %}
                            <span>Hola, {{ current_user.username }}</span>
                            <a href="{{ url_for('members.logout') }}" class="nav-auth-btn nav-auth-btn--logout" onclick="toggleMobileMenu()">Cerrar sesión</a>
                        {% else %}
                            <button type="button" class="nav-auth-btn" onclick="toggleMobileMenu(); toggleLoginModal(true);">
                                Login
                            </button>
                        {% endif %}
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="page-content">
        {% block content %}{% endblock %}
    </main>

<footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <div class="footer-logo-group">
                        <div class="footer-logo-bg">
                            <img src="{{ url_for('static', filename='images/Logo_AMPA.png') }}" alt="Logo AMPA Julián Nieto Tapia" class="footer-logo-img" />
                        </div>
                        <span class="footer-logo-title-group">
                            <span class="footer-logo-title-ampa">AMPA</span>
                            <span class="footer-logo-title-colegio">Julián Nieto Tapia</span>
                        </span>
                    </div>
                    <p class="footer-contact-list">
                        Asociación de Madres y Padres del CEIP Julián Nieto Tapia.<br>
                        Trabajando juntos por la educación de nuestros hijos.
                    </p>
                </div>
                <div>
                    <div class="footer-section-title">Enlaces Rápidos</div>
                    <div class="footer-links">
                        <a href="{{ url_for('public.home') }}" class="footer-link">Inicio</a>
                        <a href="{{ url_for('public.quienes_somos') }}" class="footer-link">Quiénes Somos</a>
                        <a href="{{ url_for('public.noticias') }}" class="footer-link">Noticias</a>
                        <a href="{{ url_for('public.eventos') }}" class="footer-link">Eventos</a>
                    </div>
                </div>
                <div>
                    <div class="footer-section-title">Recursos</div>
                    <div class="footer-links">
                        <a href="{{ url_for('public.documentos') }}" class="footer-link">Documentos</a>
                        <a href="{{ url_for('public.contacto') }}" class="footer-link">Contacto</a>
                        <a href="{{ url_for('public.faq') }}" class="footer-link">FAQ</a>
                        {% if current_user.is_authenticated %}
                            <a href="{{ url_for('members.dashboard') }}" class="footer-link">Área privada</a>
                            {% if can_manage_members %}
                                <a href="{{ url_for('members.register') }}" class="footer-link">Crear cuenta</a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
                <div>
                    <div class="footer-section-title">Contacto</div>
                    <div class="footer-contact-list">
                        <a>ampa.Juliannietotapia@email.com</a>
                        <a>976 340 620</a>
                        <a>Camino del Pilón 150</a>
                        <a>50011 Zaragoza (Miralbueno)</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; {{ current_year }} AMPA CEIP Julián Nieto Tapia. Todos los derechos reservados.</p>
            </div>
        </div>
</footer>
    <div id="login-modal" class="login-modal" aria-hidden="true">
        <div class="login-modal-dialog">
            <button class="login-modal-close" type="button" aria-label="Cerrar" onclick="toggleLoginModal(false)">×</button>
            <p class="eyebrow">Área privada</p>
            <h2>Acceder</h2>
            <p class="section-subtitle">Introduce tus credenciales para entrar en la zona de socios.</p>
            {% if header_login_form %}
            <form method="post" action="{{ url_for('members.login') }}" class="private-form">
                {{ header_login_form.hidden_tag() }}
                <div class="private-field">
                    {{ header_login_form.email.label }}
                    {{ header_login_form.email(placeholder="correo@ejemplo.com") }}
                </div>
                <div class="private-field">
                    {{ header_login_form.password.label }}
                    {{ header_login_form.password(placeholder="Tu contraseña") }}
                </div>
                <label class="private-remember">
                    {{ header_login_form.remember_me() }}
                    <span>{{ header_login_form.remember_me.label.text }}</span>
                </label>
                {{ header_login_form.submit(class_="btn-primary full") }}
            </form>
            {% endif %}
        </div>
    </div>
    <style>
        .nav-auth { display:flex; align-items:center; gap:0.75rem; margin-left:1rem; }
        .nav-auth-btn { background:#1f3ba2; color:#fff; border:none; border-radius:999px; padding:0.35rem 0.9rem; font-weight:600; cursor:pointer; text-decoration:none; white-space:nowrap; display:inline-flex; align-items:center; justify-content:center; min-width:96px; }
        .nav-auth-btn--edit { background:#ff8a4c; color:#0b1526; box-shadow:0 12px 24px rgba(255,138,76,0.35); }
        .nav-auth-btn--logout { background:#1f3ba2; order:1; }
        .nav-auth-btn:hover { opacity:0.9; }
        .nav-user-name { font-weight:600; color:#ffffff; white-space:nowrap; order:2; }
        .mobile-auth { display:flex; flex-direction:column; gap:0.5rem; margin-top:1rem; }
        .login-modal { position:fixed; inset:0; background:rgba(15,23,42,0.55); display:none; align-items:center; justify-content:center; padding:1.5rem; z-index:1200; }
        .login-modal.open { display:flex; }
        .login-modal-dialog { background:#0f172a; width:100%; max-width:520px; border-radius:24px; padding:2.5rem; box-shadow:0 55px 100px rgba(15,23,42,0.45), inset 0 1px 0 rgba(255,255,255,0.05); position:relative; color:#fff; }
        .login-modal-dialog .private-field label { color:#e2e8f0; }
        .login-modal-dialog input, .login-modal-dialog .btn-primary { border-radius:999px; }
        .login-modal-dialog input { background:rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.15); color:#fff; }
        .login-modal-dialog input::placeholder { color:rgba(255,255,255,0.6); }
        .login-modal-close { position:absolute; top:1rem; right:1rem; border:none; background:rgba(255,255,255,0.1); border-radius:999px; width:36px; height:36px; font-size:1.1rem; cursor:pointer; color:#fff; }
    </style>
    <script>
        function toggleLoginModal(show) {
            const modal = document.getElementById('login-modal');
            if (!modal) return;
            modal.classList.toggle('open', show);
            modal.setAttribute('aria-hidden', show ? 'false' : 'true');
        }
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('login-modal');
            modal?.addEventListener('click', (event) => {
                if (event.target === modal) {
                    toggleLoginModal(false);
                }
            });
            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape') {
                    toggleLoginModal(false);
                }
            });
        });
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>

{% extends "public/layout.html" %}

{% block title %}Sugerencias Â· AMPA JuliÃ¡n Nieto{% endblock %}

{% block content %}
  <section class="page-section suggestion-thread">
    <div class="thread-container">
      <header class="thread-hero card gradient-bg">
        <div class="thread-headline">
          <p class="eyebrow">Ãrea privada</p>
          <h1 class="thread-title">Sugerencias y dudas</h1>
          <p class="thread-meta">Estado actual: {{ status|capitalize }}</p>
        </div>
      </header>

      <div class="suggestion-grid">
        {% for suggestion in suggestions.items %}
          {% set likes = suggestion.votes.filter_by(value=1).count() %}
          {% set dislikes = suggestion.votes.filter_by(value=-1).count() %}
          <article class="card suggestion-card">
            <div class="card-top">
              <span class="status-pill status-{{ suggestion.status }}">{{ suggestion.status|capitalize }}</span>
              <span class="vote-chip">ğŸ‘ {{ likes }} Â· ğŸ‘ {{ dislikes }}</span>
            </div>
            <h3>{{ suggestion.title }}</h3>
            <p class="card-meta">Saldo: {{ likes - dislikes }} Â· CategorÃ­a: {{ suggestion.category|capitalize }}</p>
            <a class="btn-primary" href="{{ url_for('members.detalle_sugerencia', suggestion_id=suggestion.id) }}">Ver hilo</a>
          </article>
        {% else %}
          <p>No hay sugerencias en esta categorÃ­a.</p>
        {% endfor %}
      </div>

      <div class="pagination">
        {% if suggestions.has_prev %}
          <a class="btn-outline" href="?page={{ suggestions.prev_num }}&status={{ status }}">Anterior</a>
        {% endif %}
        {% if suggestions.has_next %}
          <a class="btn-outline" href="?page={{ suggestions.next_num }}&status={{ status }}">Siguiente</a>
        {% endif %}
      </div>
    </div>
  </section>
{% endblock %}
